<html>
    <head>
	<title>W05 task5</title>
    </head>
    <body>
	<script src="https://threejs.org/build/three.min.js"></script>
    <script src="main.js"></script>

    <p>Toon</p>
    <script type="x-shader/x-vertex" id="toon.vert">
        varying vec2 vUv;
        varying vec3 vNormal;
        varying vec4 vColor;
        varying vec4 point_position;
        varying vec3 normal_vector;

        void main() {
            vec3 pos = position;
            if(edge){
                pos += normal * 0.05;
            }
            vNormal = normal;
            vColor = color;
            vUv = uv;
            normal_vector = normalMatrix * normal;
            point_position = modelViewMatrix * vec4(pos, 1.0);
            gl_Position = projectionMatrix * point_position;
        }
	</script>

    <script type="x-shader/x-fragment" id="toon.frag">
        precision mediump float;
        varying vec2 vUv;
        uniform sampler2D texture;
        varying vec3 vNormal;
        varying vec4 vColor;
        uniform vec4 edgeColor;
        varying vec3 light_position;
        varying vec4 point_position;
        varying vec3 normal_vector;

        void main(){
            if(edgeColor.a > 0.0){
                gl_FragColor = edgeColor;
            }else{
                vec3 C = vColor;
                vec3 L = normalize(light_position - point_position.xyz);
                vec3 N = normalize(normal_vector);
                float kd = 0.5;
                float dd = max(dot(N, L), 0.0);
                float Id = kd * dd;
                gl_FragColor = vColor * texture2D(texture, vec2(Id, 0.0)); 
            }
            
        }
    </script>

    <script>
        test();
    </script>

	
    </body>
</html>
